<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-4.0.xsd">
    
    <beans:bean class="com.visa.vbv.testsuite.security.DefaultRolesPrefixPostProcessor"/>
    
    <beans:bean id="testSuiteUserDetailsServiceImpl" class="com.visa.vbv.testsuite.security.TestSuiteUserDetailsServiceImpl">
	</beans:bean>
	
	 <authentication-manager id="authenticationManager">
		<authentication-provider user-service-ref="testSuiteUserDetailsServiceImpl">
		<password-encoder hash="bcrypt" />
		</authentication-provider>
	</authentication-manager>
   
    <http auto-config="false" 
    		create-session="stateless"
    		use-expressions="true"
    		entry-point-ref="unauthorizedEntryPoint"
			authentication-manager-ref="authenticationManager"	>
			
			<custom-filter ref="authenticationTokenProcessingFilter" position="FORM_LOGIN_FILTER" />
			
			<intercept-url pattern="/index.html" access="permitAll" />
			<intercept-url pattern="/" access="permitAll" />
			
<!-- 			<intercept-url pattern="/pit1/authenticate" access="permitAll"/>
			<intercept-url pattern="/pit1/reviewPARes" access="permitAll"/>
			
			<intercept-url pattern="/pit1/dsService/veReq" access="permitAll"/>
			<intercept-url pattern="/pit1/acsService/paReq" access="permitAll"/>
			<intercept-url pattern="/pit1/ahsService/paTransReq" access="permitAll"/>
			
			<intercept-url pattern="/pit1/acss/pwd/as" access="permitAll"/>
			<intercept-url pattern="/pit1/acss/ads/as" access="permitAll"/>
			<intercept-url pattern="/pit1/acss/processVEReq" access="permitAll"/>
			<intercept-url pattern="/pit1/acss/processPAReq" access="permitAll"/> -->
	
			<intercept-url pattern="/pit2/acss/AReq" access="permitAll"/>
			<intercept-url pattern="/pit2/acss/BrowserCReq" access="permitAll"/>
			<intercept-url pattern="/pit2/acss/InAppCReq" access="permitAll"/>
			<intercept-url pattern="/pit2/acss/pwd/as" access="permitAll"/>
			<intercept-url pattern="/pit2/acss/ads/as" access="permitAll"/>
			
			<intercept-url pattern="/pit2/reviewBrowserCReq" access="permitAll"/>
			<intercept-url pattern="/pit2/reviewBrowserCRes" access="permitAll"/>
			<intercept-url pattern="/pit2/reviewCTHBrowserCReq" access="permitAll"/>
			<intercept-url pattern="/pit2/reviewCTHBrowserCRes" access="permitAll"/>
			
			<intercept-url pattern="/pit2/DS2/authenticate" access="permitAll"/>
			<intercept-url pattern="/pit2/acs2Service/browserCReq" access="permitAll"/>
			<intercept-url pattern="/pit2/acs2Service/inAppCReq" access="permitAll"/>
			<intercept-url pattern="/pit2/DS2/PReq" access="permitAll"/>
			<intercept-url pattern="/pit2/buildNumber" access="permitAll"/>
			<intercept-url pattern="/pit2/mpi/rreq" access="permitAll"/>
			
			<intercept-url pattern="/user/editEnrolledUser" access="hasAnyRole('ADMIN','PIT1_ACS','PIT1_MRCH','PIT2_ACS','PIT2_MRCH')"/>
			<intercept-url pattern="/user/updateEnrolledUser" access="hasAnyRole('ADMIN','PIT1_ACS','PIT1_MRCH','PIT2_ACS','PIT2_MRCH')"/>
			<intercept-url pattern="/user/logout" access="hasAnyRole('ADMIN','PIT1_ACS','PIT1_MRCH','PIT2_ACS','PIT2_MRCH')"/>
			
			<!-- ====Intercept urls to allow vendor compliance letter request approval or denial=== -->
			<intercept-url pattern="/pit2/vendorComplianceLetterReq"  access="permitAll"/>
			<intercept-url pattern="/pit2/getVendorDataForComplReqApproval"  access="permitAll"/>
			<intercept-url pattern="/pit2/approveComplianceLetter"  access="permitAll"/>
			<intercept-url pattern="/pit2/denyComplianceLetter"  access="permitAll"/>
			<!-- ============End============= -->
			
			<intercept-url pattern="/pit1/**" access="hasAnyRole('ADMIN','PIT1_ACS','PIT1_MRCH')"/>
			<intercept-url pattern="/pit2/**" access="hasAnyRole('ADMIN','PIT2_ACS','PIT2_MRCH')"/>
			<intercept-url pattern="/user/**" access="permitAll"/>
			
			

			<intercept-url pattern="/app/directives/**" access="permitAll" />
            <intercept-url pattern="/app/documents/**" access="permitAll" />
            <intercept-url pattern="/app/images/**" access="permitAll" />
            <intercept-url pattern="/app/styles/**" access="permitAll" />
            <intercept-url pattern="/app/vendor/**" access="permitAll" />
           <!--  <intercept-url pattern="/app/pit2/secure/controllers/**" access="permitAll" />
            <intercept-url pattern="/app/pit2/secure/services/**" access="permitAll" />
            --> 
            <intercept-url pattern="/app/pit2/secure/**" access="permitAll" />
            <intercept-url pattern="/app/certs/**" access="permitAll" />
            <intercept-url pattern="/app/common/**" access="permitAll" />
            
            <intercept-url pattern="/app/partials/_login.html" access="permitAll" />
            <intercept-url pattern="/app/partials/_changePassword.html" access="permitAll" />
            <intercept-url pattern="/app/partials/_userEnrollment.html" access="permitAll" />
            <intercept-url pattern="/app/partials/_termsConditions.html" access="permitAll" />
            <!-- <intercept-url pattern="/app/pit2/secure/partials/**" access="hasAnyRole('ADMIN','PIT2_ACS','PIT2_MRCH')"/> -->  
            
			 <headers>
	        	<frame-options disabled="true"/>
	        </headers> 
        <csrf disabled="true"/> 	
    </http>
    
    <beans:bean id="unauthorizedEntryPoint" class="com.visa.vbv.testsuite.security.EntryPointUnAuthorizedHandler" />
    
    <beans:bean class="com.visa.vbv.testsuite.security.AuthenticationTokenProcessingFilter" id="authenticationTokenProcessingFilter">
		<beans:constructor-arg ref="testSuiteUserDetailsServiceImpl" />
	</beans:bean>
     
</beans:beans>