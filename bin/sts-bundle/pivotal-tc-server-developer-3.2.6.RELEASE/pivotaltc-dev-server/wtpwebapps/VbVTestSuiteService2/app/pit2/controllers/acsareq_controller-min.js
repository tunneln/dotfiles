"use strict";var acsAReqMod=angular.module("ACSAReqModule",[]);acsAReqMod.controller("ACSAReqCtrl",["$scope","AdministerTestsServicePIT2","$rootScope","$window",function(c,b,a,d){c.loading=false;c.pageloaded=true;c.componentType="ACS";c.applnId="PIT2";c.msgType="AReq";c.testCaseType="02";c.selectedTestCase;c.testCaseName;c.successorCReqTC;c.requiredByRegion;c.pitAction;c.aReqTemplate;c.aReqTemplate={};c.compliance;c.previousTestCase;c.selectedRegions=[];c.regions=[{value:"U.S.A",rgnCd:"01",flag:false},{value:"CANADA",rgnCd:"02",flag:false},{value:"E.U.",rgnCd:"03",flag:false},{value:"ASIAPAC",rgnCd:"04",flag:false},{value:"LAT.AM.",rgnCd:"05",flag:false},{value:"C.E.M.E.A.",rgnCd:"06",flag:false}];c.pitActions=["None","Directory server uses invalid client certificate","Use E-Commerce client SSL/TLS Cert"];c.expectedResponses=[{value:"3-D Secure Error Message",selected:false},{value:"Invalid Certificate Error",selected:false},{value:"Transaction Status = N",selected:false},{value:"Transaction Status = C",selected:false},{value:"Transaction Status = Y",selected:false},{value:"Transaction Status = R",selected:false},{value:"Transaction Status = A",selected:false}];c.selectedTestCaseObj={};c.optionExpectedRes;c.actionTemplates=[];c.selectedExpResps=[];c.cReqSuccessorIdTCs=[];c.isExistingTC=false;c.getTestCases=function(f,e){c.tcResData=[];c.testCases=[];c.actionTemplates=[];b.getTestCases(f,e).then(function(g){c.tcResData=g.data;if(c.tcResData.length>0){if(g.data[0].testCaseId!=null&&g.data[0].testCaseId!=undefined&&g.data[0].testCaseId!=""){c.isExistingTC=true;angular.forEach(c.tcResData,function(i){c.testCases.push({tcId:i.testCaseId,tcDesc:i.tc_desc})});if(c.previousTestCase>0||c.previousTestCase!=null){var h=c.tcResData.map(function(i){return i.testCaseId}).indexOf(c.previousTestCase);c.selectedTestCaseObj=c.tcResData[h];c.setData(c.selectedTestCaseObj);c.previousTestCase=null}else{c.selectedTestCaseObj=c.tcResData[0];c.setData(c.selectedTestCaseObj)}}else{c.isExistingTC=false;c.pageloaded=false;c.pitAction="None";c.aReqTemplate="";c.cReqSuccessorIdTCs=c.tcResData[0].successorIdTCs}}else{if(c.tcResData.length==0){c.isExistingTC=false;c.pageloaded=false;c.pitAction="None";c.aReqTemplate=""}else{c.isExistingTC=false}}})};c.getTestCases(c.msgType,c.testCaseType);c.setData=function(e){c.expectedResMsg=[];c.selectedExpResps=[];c.compliance=e.compliance;c.selectedTestCase=e.testCaseId;c.testCaseName=e.tcName;c.successorCReqTC=e.selectedSuccessorId;c.expectedResMsg=e.expctdRespAcs;if(e.tcActionTmpl.length>0){c.pitAction=e.tcActionTmpl[0].actnTemplName}if(e.region.length>0){c.selectedRegions=[];angular.forEach(e.region,function(f){c.selectedRegions.push(f.regnCd)});angular.forEach(c.regions,function(f){if(c.selectedRegions.indexOf(f.rgnCd)!=-1){f.flag=true}else{f.flag=false}})}else{c.selectedRegions=[];angular.forEach(c.regions,function(f){f.flag=false})}if(e.expectedMshg.length>0){angular.forEach(e.expectedMshg,function(f){c.selectedExpResps.push(f.exptRespDesc)})}c.cReqSuccessorIdTCs=e.successorIdTCs;c.aReqTemplate=vkbeautify.json(e.templeteMsg,1);c.pageloaded=false};c.changeTCReqData=function(f){a.showErrorAlert=false;var e=c.tcResData.map(function(g){return g.testCaseId}).indexOf(f);if(e!=-1){c.isExistingTC=true;c.selectedTestCaseObj=c.tcResData[e];c.setData(c.selectedTestCaseObj)}else{c.isExistingTC=false;c.selectedTestCase="";c.testCaseName="";c.pitAction="None";c.aReqTemplate="";c.selectedRegions=[];c.expectedResMsg="";c.actionTemplates=[];c.selectedExpResps=[];c.successorCReqTC="";angular.forEach(c.regions,function(g){g.flag=false})}};c.selectedRegion=function(f){if(c.selectedRegions.length>0){var e;angular.forEach(c.selectedRegions,function(g){if(g===f){e=c.selectedRegions.indexOf(g)}});if(e!=undefined){c.selectedRegions.splice(e,1)}else{c.selectedRegions.push(f)}}else{c.selectedRegions.push(f)}};c.jsonFormat=function(f){if(f=="AReq"){var g=c.aReqTemplate;c.aReqTemplate=vkbeautify.json(g,1)}if(f=="expAReqResp"){var e=c.expectedResMsg;c.expectedResMsg=vkbeautify.json(e,1)}};c.jsonUnformat=function(f){if(f=="AReq"){var g=c.aReqTemplate;c.aReqTemplate=vkbeautify.jsonmin(g)}if(f=="expAReqResp"){var e=c.expectedResMsg;c.expectedResMsg=vkbeautify.jsonmin(e)}};c.acsAReqSubmit=function(f,g){if(c.selectedExpResps==null||c.selectedExpResps==""||c.selectedExpResps==undefined){a.showSuccessAlert=false;a.showErrorAlert=true;a.errorMessage="Please select the Expected Test Case Result field";return}c.actionTemplates=[];c.actionTemplates.push(c.pitAction);var h={operationType:f,testCaseId:c.selectedTestCase,tcName:c.testCaseName,templeteMsg:c.aReqTemplate,regnCds:c.selectedRegions,actnTemplName:c.actionTemplates,expctdRespAcs:c.expectedResMsg,exptRespDesc:c.selectedExpResps,selectedSuccessorId:c.successorCReqTC,componentType:c.componentType,applnId:c.applnId,msgType:c.msgType,deviceChannel:c.testCaseType,compliance:c.compliance};c.loading=true;b.createNewTestCase(h).then(function(i){c.loading=false;c.getTestCases(c.msgType,c.testCaseType);a.showErrorAlert=false;a.showSuccessAlert=true;if(f=="create"){a.successMessage="ACS AReq Browser test case '"+c.testCaseName+"' created"}else{if(f=="update"){a.successMessage="ACS AReq Browser test case '"+c.testCaseName+"' updated";c.previousTestCase=c.selectedTestCase}else{if(f=="delete"){a.successMessage="ACS AReq Browser test case '"+c.testCaseName+"' deleted"}}}d.scrollTo(0,0)},function e(i){c.loading=false;a.showSuccessAlert=false;a.showErrorAlert=true;if(i.data.errorMessage!=null){a.errorMessage=i.data.errorMessage}else{a.errorMessage="Transaction Failed"}d.scrollTo(0,0)})};c.deleteConfirm=function(){if(d.confirm("Are you sure you want to delete '"+c.testCaseName+"' test case")){c.acsAReqSubmit("delete")}};c.optionExpRes=function(){b.getUseTemplate().then(function(e){c.expectedResMsg=vkbeautify.json(e.data)})};c.expRespJsonFormat=function(){var e=c.expectedResMsg;if(c.expectedResMsg!=""&&c.expectedResMsg!=null){c.expectedResMsg=vkbeautify.json(e,1)}else{return}};c.expRespJsonUnformat=function(){var e=c.expectedResMsg;if(c.expectedResMsg!=""&&c.expectedResMsg!=null){c.expectedResMsg=vkbeautify.jsonmin(e)}else{return}}}]);