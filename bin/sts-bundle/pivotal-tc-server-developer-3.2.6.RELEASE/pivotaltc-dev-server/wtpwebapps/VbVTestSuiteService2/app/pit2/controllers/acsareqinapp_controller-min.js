"use strict";var acsAReqMod=angular.module("ACSAReqModuleInApp",[]);acsAReqMod.controller("ACSAReqCtrlInApp",["$scope","AdministerTestsServiceInappPIT2","$rootScope","$window",function(b,d,a,c){b.loading=false;b.pageloaded=true;b.componentType="ACS";b.applnId="PIT2";b.msgType="AReq";b.testCaseType="01";b.selectedTestCase;b.testCaseName;b.successorCReqTC=[];b.requiredByRegion;b.pitAction;b.aReqTemplate;b.aReqTemplate={};b.compliance;b.previousTestCase;b.selectedRegions=[];b.regions=[{value:"U.S.A",rgnCd:"01",flag:false},{value:"CANADA",rgnCd:"02",flag:false},{value:"E.U.",rgnCd:"03",flag:false},{value:"ASIAPAC",rgnCd:"04",flag:false},{value:"LAT.AM.",rgnCd:"05",flag:false},{value:"C.E.M.E.A.",rgnCd:"06",flag:false}];b.pitActions=["None","Directory server uses invalid client certificate","Use E-Commerce client SSL/TLS Cert"];b.expectedResponses=[{value:"3-D Secure Error Message",selected:false},{value:"Invalid Certificate Error",selected:false},{value:"Transaction Status = N",selected:false},{value:"Transaction Status = C",selected:false},{value:"Transaction Status = Y",selected:false},{value:"Transaction Status = R",selected:false},{value:"Transaction Status = A",selected:false}];b.selectedTestCaseObj={};b.optionExpectedRes;b.actionTemplates=[];b.selectedExpResps=[];b.cReqSuccessorIdTCs=[];b.successorCReqTC=[];b.isExistingTC=false;b.getTestCases=function(f,e){b.tcResData=[];b.testCases=[];d.getTestCases(f,e).then(function(g){b.tcResData=g.data;if(b.tcResData.length>0){if(g.data[0].testCaseId!=null&&g.data[0].testCaseId!=undefined&&g.data[0].testCaseId!=""){b.isExistingTC=true;angular.forEach(b.tcResData,function(i){b.testCases.push({tcId:i.testCaseId,tcDesc:i.tc_desc})});if(b.previousTestCase>0||b.previousTestCase!=null){var h=b.tcResData.map(function(i){return i.testCaseId}).indexOf(b.previousTestCase);b.selectedTestCaseObj=b.tcResData[h];b.setData(b.selectedTestCaseObj);b.previousTestCase=null}else{b.selectedTestCaseObj=b.tcResData[0];b.setData(b.selectedTestCaseObj)}}else{b.isExistingTC=false;b.pageloaded=false;b.pitAction="None";b.aReqTemplate="";b.cReqSuccessorIdTCs=b.tcResData[0].successorIdTCs}}else{if(b.tcResData.length==0){b.isExistingTC=false;b.pageloaded=false;b.pitAction="None";b.aReqTemplate=""}else{b.isExistingTC=false}}})};b.getTestCases(b.msgType,b.testCaseType);b.setData=function(e){b.successorCReqTC=[];b.expectedResMsg=[];b.selectedExpResps=[];b.selectedTestCase=e.testCaseId;b.compliance=e.compliance;b.testCaseName=e.tcName;b.expectedResMsg=e.expctdRespAcs;if(e.tcActionTmpl.length>0){b.pitAction=e.tcActionTmpl[0].actnTemplName}if(e.region.length>0){b.selectedRegions=[];angular.forEach(e.region,function(f){b.selectedRegions.push(f.regnCd)});angular.forEach(b.regions,function(f){if(b.selectedRegions.indexOf(f.rgnCd)!=-1){f.flag=true}else{f.flag=false}})}else{b.selectedRegions=[];angular.forEach(b.regions,function(f){f.flag=false})}if(e.expectedMshg.length>0){angular.forEach(e.expectedMshg,function(f){b.selectedExpResps.push(f.exptRespDesc)})}b.cReqSuccessorIdTCs=e.successorIdTCs;if(e.selectedSuccIdTCs!=null){if(e.selectedSuccIdTCs.length>0){b.successorCReqTC=e.selectedSuccIdTCs}}b.aReqTemplate=vkbeautify.json(e.templeteMsg,1);b.pageloaded=false};b.changeTCReqData=function(f){a.showErrorAlert=false;var e=b.tcResData.map(function(g){return g.testCaseId}).indexOf(f);if(e!=-1){b.isExistingTC=true;b.selectedTestCaseObj=b.tcResData[e];b.setData(b.selectedTestCaseObj)}else{b.isExistingTC=false;b.selectedTestCase="";b.testCaseName="";b.pitAction="None";b.aReqTemplate="";b.selectedRegions=[];b.expectedResMsg="";b.selectedExpResps=[];b.successorCReqTC=[];angular.forEach(b.regions,function(g){g.flag=false})}};b.selectedRegion=function(f){if(b.selectedRegions.length>0){var e;angular.forEach(b.selectedRegions,function(g){if(g===f){e=b.selectedRegions.indexOf(g)}});if(e!=undefined){b.selectedRegions.splice(e,1)}else{b.selectedRegions.push(f)}}else{b.selectedRegions.push(f)}};b.jsonFormat=function(f){if(f=="AReq"){var g=b.aReqTemplate;b.aReqTemplate=vkbeautify.json(g,1)}if(f=="expAReqResp"){var e=b.expectedResMsg;b.expectedResMsg=vkbeautify.json(e,1)}};b.jsonUnformat=function(f){if(f=="AReq"){var g=b.aReqTemplate;b.aReqTemplate=vkbeautify.jsonmin(g)}if(f=="expAReqResp"){var e=b.expectedResMsg;b.expectedResMsg=vkbeautify.jsonmin(e)}};b.acsAReqSubmit=function(f,g){if(b.selectedExpResps==null||b.selectedExpResps==""||b.selectedExpResps==undefined){a.showSuccessAlert=false;a.showErrorAlert=true;a.errorMessage="Please select the Expected Test Case Result field";return}b.actionTemplates=[];b.actionTemplates.push(b.pitAction);var h={operationType:f,testCaseId:b.selectedTestCase,tcName:b.testCaseName,templeteMsg:b.aReqTemplate,regnCds:b.selectedRegions,actnTemplName:b.actionTemplates,expctdRespAcs:b.expectedResMsg,exptRespDesc:b.selectedExpResps,successorIdTCs:b.successorCReqTC,componentType:b.componentType,applnId:b.applnId,msgType:b.msgType,deviceChannel:b.testCaseType,compliance:b.compliance};b.loading=true;d.createNewTestCase(h).then(function(i){b.loading=false;b.getTestCases(b.msgType,b.testCaseType);a.showErrorAlert=false;a.showSuccessAlert=true;if(f=="create"){a.successMessage="ACS AReq InApp test case '"+b.testCaseName+"' created"}else{if(f=="update"){a.successMessage="ACS AReq InApp test case '"+b.testCaseName+"' updated";b.previousTestCase=b.selectedTestCase}else{if(f=="delete"){a.successMessage="ACS AReq InApp test case '"+b.testCaseName+"' deleted"}}}c.scrollTo(0,0)},function e(i){b.loading=false;a.showSuccessAlert=false;a.showErrorAlert=true;if(i.data.errorMessage!=null){a.errorMessage=i.data.errorMessage}else{a.errorMessage="Transaction Failed"}c.scrollTo(0,0)})};b.deleteConfirm=function(){if(c.confirm("Are you sure you want to delete '"+b.testCaseName+"' test case")){b.acsAReqSubmit("delete")}};b.optionExpRes=function(){d.getUseTemplate().then(function(e){b.expectedResMsg=vkbeautify.json(e.data)})};b.expRespJsonFormat=function(){var e=b.expectedResMsg;if(b.expectedResMsg!=""&&b.expectedResMsg!=null){b.expectedResMsg=vkbeautify.json(e,1)}else{return}};b.expRespJsonUnformat=function(){var e=b.expectedResMsg;if(b.expectedResMsg!=""&&b.expectedResMsg!=null){b.expectedResMsg=vkbeautify.jsonmin(e)}else{return}}}]);