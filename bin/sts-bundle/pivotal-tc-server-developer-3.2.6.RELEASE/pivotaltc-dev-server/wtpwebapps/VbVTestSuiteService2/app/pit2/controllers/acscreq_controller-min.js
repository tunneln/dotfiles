"use strict";var acsCReqMod=angular.module("ACSCReqModule",[]);acsCReqMod.controller("ACSCReqCtrl",["$scope","AdministerTestsServicePIT2","$rootScope","$window",function(c,b,a,d){c.loading=false;c.pageloaded=true;c.componentType="ACS";c.applnId="PIT2";c.msgType="CReq";c.testCaseType="02";c.selectedTestCase;c.testCaseName;c.expectedTCResult=[];c.pitAction;c.cReqTemplate;c.compliance;c.previousTestCase;c.pitActions=["None","Include newlines in BASE64"];c.expectedResponses=[{value:"3-D Secure Error Message",selected:false},{value:"Authentication Status = Y",selected:false},{value:"Authentication Status = A",selected:false},{value:"Authentication Status = N",selected:false},{value:"Transaction Status = Y",selected:false},{value:"Transaction Status = N",selected:false},{value:"Transaction Status = A",selected:false},{value:"Transaction Status = C",selected:false},{value:"Transaction Status = R",selected:false}];c.selectedTestCaseObj={};c.optionExpectedRes;c.actionTemplates=[];c.selectedExpResps=[];c.isExistingTC=false;c.jsonFormat=function(g){if(g=="CReq"){var e=c.cReqTemplate;c.cReqTemplate=vkbeautify.json(e,1)}if(g=="expCReqResp"){var f=c.expectedResMsg;c.expectedResMsg=vkbeautify.json(f,1)}};c.jsonUnformat=function(g){if(g=="CReq"){var e=c.cReqTemplate;c.cReqTemplate=vkbeautify.jsonmin(e)}if(g=="expCReqResp"){var f=c.expectedResMsg;c.expectedResMsg=vkbeautify.jsonmin(f)}};c.getTestCases=function(f,e){c.testCases=[];c.tcResData=[];c.actionTemplates=[];b.getTestCases(f,e).then(function(g){c.tcResData=g.data;if(c.tcResData.length>0){c.isExistingTC=true;angular.forEach(c.tcResData,function(i){c.testCases.push({tcId:i.testCaseId,tcDesc:i.tc_desc})});if(c.previousTestCase>0||c.previousTestCase!=null){var h=c.tcResData.map(function(i){return i.testCaseId}).indexOf(c.previousTestCase);c.selectedTestCaseObj=c.tcResData[h];c.setData(c.selectedTestCaseObj);c.previousTestCase=null}else{c.selectedTestCaseObj=c.tcResData[0];c.setData(c.selectedTestCaseObj)}}else{if(c.tcResData.length==0){c.isExistingTC=false;c.pageloaded=false;c.pitAction="None";c.cReqTemplate=""}else{c.isExistingTC=false}}})};c.getTestCases(c.msgType,c.testCaseType);c.setData=function(e){c.selectedExpResps=[];c.compliance=e.compliance;c.selectedTestCase=e.testCaseId;c.testCaseName=e.tcName;c.expectedResMsg=e.expctdRespAcs;if(e.tcActionTmpl.length>0){c.pitAction=e.tcActionTmpl[0].actnTemplName}if(e.expectedMshg.length>0){angular.forEach(e.expectedMshg,function(f){c.selectedExpResps.push(f.exptRespDesc)})}c.cReqTemplate=e.templeteMsg;c.pageloaded=false};c.changeTCReqData=function(f){a.showErrorAlert=false;var e=c.tcResData.map(function(g){return g.testCaseId}).indexOf(f);if(e!=-1){c.isExistingTC=true;c.selectedTestCaseObj=c.tcResData[e];c.setData(c.selectedTestCaseObj)}else{c.isExistingTC=false;c.selectedTestCase="";c.testCaseName="";c.pitAction="None";c.actionTemplates=[];c.expectedResMsg="";c.cReqTemplate="";c.selectedExpResps=[]}};c.acsCReqSubmit=function(g,h){if(c.selectedExpResps==null||c.selectedExpResps==""||c.selectedExpResps==undefined){a.showSuccessAlert=false;a.showErrorAlert=true;a.errorMessage="Please select the Expected Test Case Result field";return}c.actionTemplates=[];c.actionTemplates.push(c.pitAction);var i={operationType:g,testCaseId:c.selectedTestCase,tcName:c.testCaseName,templeteMsg:c.cReqTemplate,actnTemplName:c.actionTemplates,expctdRespAcs:c.expectedResMsg,exptRespDesc:c.selectedExpResps,componentType:c.componentType,applnId:c.applnId,msgType:c.msgType,deviceChannel:c.testCaseType,compliance:c.compliance};c.loading=true;b.createNewTestCase(i).then(function e(j){c.loading=false;c.getTestCases(c.msgType,c.testCaseType);a.showErrorAlert=false;a.showSuccessAlert=true;if(g=="create"){a.successMessage="ACS CReq Browser test case '"+c.testCaseName+"' created"}else{if(g=="update"){a.successMessage="ACS AReq Browser test case '"+c.testCaseName+"' updated";c.previousTestCase=c.selectedTestCase}else{if(g=="delete"){a.successMessage="ACS CReq Browser test case '"+c.testCaseName+"' deleted"}}}d.scrollTo(0,0)},function f(j){c.loading=false;a.showSuccessAlert=false;a.showErrorAlert=true;if(j.data.errorMessage!=null){a.errorMessage=j.data.errorMessage}else{a.errorMessage="Transaction Failed"}d.scrollTo(0,0)})};c.deleteConfirm=function(){if(d.confirm("Are you sure you want to delete '"+c.testCaseName+"' test case")){c.acsCReqSubmit("delete")}};c.optionExpRes=function(){b.getUseTemplate().then(function(e){c.expectedResMsg=vkbeautify.json(e.data)})};c.expRespJsonFormat=function(){var e=c.expectedResMsg;if(c.expectedResMsg!=""&&c.expectedResMsg!=null){c.expectedResMsg=vkbeautify.json(e,1)}else{return}};c.expRespJsonUnformat=function(){var e=c.expectedResMsg;if(c.expectedResMsg!=""&&c.expectedResMsg!=null){c.expectedResMsg=vkbeautify.jsonmin(e)}else{return}}}]);