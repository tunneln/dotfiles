"use strict";var concludeTestingMod=angular.module("ConcludeTestingMod",[]);concludeTestingMod.controller("ConcludeTestingCtrl",["$scope","$rootScope","$state","$localStorage","ConcludeTestingService","$window",function(b,a,d,c,f,e){b.userDetails=c.userData;b.isComplRequested=false;b.isPageloading=false;b.loading=false;b.complianceDetails=[];b.selectedComplDetail={};b.getComplianceStatus=function(){var i={UserName:b.userDetails.username};b.isPageloading=true;f.getComplianceStatus(i).then(function g(j){console.log("The vendor conclude testing response data :: "+j.data);b.complianceDetails=j.data;angular.forEach(b.complianceDetails,function(k){if(k.ProductType=="MPI"){k.ProductType="3DSS"}console.log("Ref num :: "+k.RefNum)});console.log("$scope.complianceDetails length :: "+b.complianceDetails.length);b.isPageloading=false},function h(j){b.complianceDetails=[];b.isPageloading=false;console.log("No Results found")})};b.getComplianceStatus();b.showComplRequestTable=function(g,h){b.isComplRequested=true;b.selectedProdIndex=g;b.companyName=h.CompanyName;b.productType=h.ProductType;b.threeDSVersion="3DS 2.0";b.prodName="";b.productVersion="";b.emvcoRefNo=h.RefNum;if(b.productType=="3DSS"){b.isMPI=true}else{b.isMPI=false}};b.submitComplLetterReq=function(){if(b.productType=="3DSS"){b.productType1="MPI"}else{b.productType1=b.productType}var i={UserName:b.userDetails.username,CompanyName:b.companyName,ProductType:b.productType1,RefNum:b.emvcoRefNo,ProductName:b.prodName,ProductVersion:b.productVersion};b.loading=true;f.submitComplLetterReq(i).then(function g(j){b.complianceDetails[b.selectedProdIndex].ComplianceStatus=j.data.ComplianceStatus;a.showSuccessAlert=true;a.showErrorAlert=false;b.isComplRequested=false;a.successMessage="Your compliance letter request has been submitted and is currently being reviewed by Visa GCT team. You should be receiving the compliance letter in 2 Business days. Please contact gctv3dsts@visa.com if you have any questions.";b.loading=false;e.scrollTo(0,0)},function h(j){b.loading=false;console.log("failed to submit the request for compliance letter");a.showSuccessAlert=false;a.showErrorAlert=true;if(response.data.errorMessage!=undefined&&response.data.errorMessage!=null){a.errorMessage=response.data.errorMessage}else{a.errorMessage="Request for compliance letter has failed, please contact system administrator."}e.scrollTo(0,0)})};b.cancelComplLetterReq=function(){b.isComplRequested=false;b.selectedProdIndex=-1;b.companyName="";b.productType="";b.emvcoRefNo="";b.prodName="";b.productVersion=""}}]);