"use strict";cthModule.controller("CTHRunACSTestController",["$scope","CTHRunACSTest","$window","$state","$rootScope",function(b,e,d,c,a){b.isPageLoading=false;b.submitBtn=true;b.testCases=[];b.service=e;a.isCTHMPITesting=false;b.panNumber="";b.cardExpiryDate="";b.updateSuccMsg="";b.selectedTCData={};b.urlChange=function(){if(b.url!=undefined){var f=b.url.split("/");if(f.length>0){var g="/"+f[f.length-2]+"/"+f[f.length-1];if(g!=undefined&&g=="/DS2/authenticate"){a.isCTHMPITesting=true}else{a.isCTHMPITesting=false}}else{a.isCTHMPITesting=false}}else{a.isCTHMPITesting=false}};b.setTestCaseData=function(){b.isPageLoading=true;b.selectedTCData=b.service.selectedTCData;b.url=b.selectedTCData.acsUrl;b.selectedTCName=b.selectedTCData.testcaseName;b.AReq=b.selectedTCData.AReq;b.selectedTCId=b.selectedTCData.testcaseId;b.isPageLoading=false;b.urlChange()};b.setTestCaseData();b.change=function(f){if(f!=null){e.getAReq(f).then(function(g){b.AReq=vkbeautify.json(g.data.RequestMessage,2)})}else{b.AReq=""}};b.submitAReq=function(){var f=true;var g=b.url;var h=g.replace(/\<|\>|\"|\#|\'|%|\;|\(|\)|\&|\+|\-/g,"");if(g.length!=h.length){a.showErrorAlert=true;a.errorMessage="ACS URL should not contain )(#&><\"'%;+- characters";f=false}if(f){b.submitBtn=false;b.loading=true;e.submitAReq(b.url,b.selectedTCId,b.AReq).success(function(i){b.service.data=i;b.service.reqTestCase=b.selectedTCId.value;c.go("PIT2.CTHrunACSTestRes")}).error(function(j,i){c.go("PIT2.CTHrunACSTest");b.loading=false;b.submitBtn=true})}};b.updateTemplateMessage=function(f,g){console.log("pan number : "+f);console.log("Card expiry date : "+g);b.panNumber=f;b.cardExpiryDate=g;if(b.AReq!=undefined&&b.AReq!=""){b.AReqJSONObj=angular.fromJson(b.AReq);if(b.panNumber!=undefined&&b.panNumber!=""){b.AReqJSONObj.acctNumber=b.panNumber}if(b.cardExpiryDate!=undefined&&b.cardExpiryDate!=""){b.AReqJSONObj.cardExpiryDate=b.cardExpiryDate}if((b.panNumber!=undefined&&b.panNumber!="")&&(b.cardExpiryDate==undefined||b.cardExpiryDate=="")){b.updateSuccMsg="Account # value updated successfully"}else{if((b.cardExpiryDate!=undefined&&b.cardExpiryDate!="")&&(b.panNumber==undefined||b.panNumber=="")){b.updateSuccMsg="Expiry Date value updated successfully"}else{if((b.panNumber!=undefined&&b.panNumber!="")&&(b.cardExpiryDate!=undefined&&b.cardExpiryDate!="")){b.updateSuccMsg="Account # and Expiry Date values updated successfully"}else{b.updateSuccMsg=""}}}}b.AReq=vkbeautify.json(JSON.stringify(b.AReqJSONObj),2)};b.jsonFormat=function(){var f=b.AReq;b.AReq=vkbeautify.json(f,1)};b.jsonUnformat=function(){var f=b.AReq;b.AReq=vkbeautify.jsonmin(f)};b.back=function(){e.acsUrl=b.url;b.onlyACS=b.service.onlyACS;if(b.onlyACS==true){c.go("PIT2.RequiredTestCases")}else{c.go("PIT2.RequiredACS3DSTestCases")}}}]);