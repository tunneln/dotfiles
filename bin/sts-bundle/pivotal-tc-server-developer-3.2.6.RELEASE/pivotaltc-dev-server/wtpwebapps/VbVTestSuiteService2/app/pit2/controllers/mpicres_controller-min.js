"use strict";var mpiCResMod=angular.module("MPICResModule",[]);mpiCResMod.controller("MPICResCtrl",["$scope","AdministerTestsServicePIT2","$rootScope","$window",function(c,b,a,d){c.loading=false;c.pageloaded=true;c.componentType="MPI";c.applnId="PIT2";c.msgType="CRes";c.testCaseType="02";c.selectedTestCase;c.testCaseName;c.requiredByRegion;c.pan;c.pitAction;c.cResTemplate;c.compliance;c.previousTestCase;c.actionTemplates=[];c.pitActions=["None","Generate Invalid ACS Signature","Use Expired ACS Signing Certificate","Include newlines in BASE64","Use ECommerce Signing Certificate"];c.selectedTestCaseObj={};c.isExistingTC=false;c.cResTemplate={};c.cReqMandFields;c.getTestCases=function(f,e){c.testCases=[];c.tcResData=[];c.actionTemplates=[];b.getTestCases(f,e).then(function(g){c.tcResData=g.data;if(c.tcResData.length>0){c.isExistingTC=true;angular.forEach(c.tcResData,function(i){c.testCases.push({tcId:i.testCaseId,tcDesc:i.tc_desc})});if(c.previousTestCase>0||c.previousTestCase!=null){var h=c.tcResData.map(function(i){return i.testCaseId}).indexOf(c.previousTestCase);c.selectedTestCaseObj=c.tcResData[h];c.setData(c.selectedTestCaseObj);c.previousTestCase=null}else{c.selectedTestCaseObj=c.tcResData[0];c.setData(c.selectedTestCaseObj)}}else{if(c.tcResData.length==0){c.isExistingTC=false;c.pageloaded=false;c.pitAction="None";c.cResTemplate="";c.cReqMandFields=""}else{c.isExistingTC=false}}})};c.getTestCases(c.msgType,c.testCaseType);c.setData=function(e){c.selectedTestCase=e.testCaseId;c.testCaseName=e.tcName;c.compliance=e.compliance;c.cReqMandFields=e.expctdMpiReqFields;c.pan=e.pan;if(e.tcActionTmpl.length>0){c.pitAction=e.tcActionTmpl[0].actnTemplName}c.cResTemplate=e.templeteMsg;c.pageloaded=false;console.log("template :: "+e.tcActionTmpl[0].actnTemplName)};c.jsonFormat=function(f){if(f=="CRes"){var g=c.cResTemplate;c.cResTemplate=vkbeautify.json(g,1)}if(f=="expCResResp"){var e=c.expectedResMsg;c.expectedResMsg=vkbeautify.json(e,1)}};c.jsonUnformat=function(f){if(f=="CRes"){var g=c.cResTemplate;c.cResTemplate=vkbeautify.jsonmin(g)}if(f=="expCResResp"){var e=c.expectedResMsg;c.expectedResMsg=vkbeautify.jsonmin(e)}};c.changeTCReqData=function(f){var e=c.tcResData.map(function(g){return g.testCaseId}).indexOf(f);if(e!=-1){c.isExistingTC=true;c.selectedTestCaseObj=c.tcResData[e];c.setData(c.selectedTestCaseObj)}else{c.isExistingTC=false;c.selectedTestCase="";c.testCaseName="";c.pan="";c.pitAction="None";c.cResTemplate="";c.actionTemplates=[];c.cReqMandFields=""}};c.mpiCResSubmit=function(g,h){c.actionTemplates=[];c.actionTemplates.push(c.pitAction);var i={operationType:g,testCaseId:c.selectedTestCase,tcName:c.testCaseName,pan:c.pan,templeteMsg:c.cResTemplate,actnTemplName:c.actionTemplates,componentType:c.componentType,applnId:c.applnId,msgType:c.msgType,deviceChannel:c.testCaseType,compliance:c.compliance,expctdMpiReqFields:c.cReqMandFields};console.log("action tempalte :: "+c.actionTemplates);c.loading=true;b.createNewTestCase(i).then(function e(j){c.loading=false;c.getTestCases(c.msgType,c.testCaseType);a.showErrorAlert=false;a.showSuccessAlert=true;if(g=="create"){a.successMessage="3DS CRes Browser test case '"+c.testCaseName+"' created"}else{if(g=="update"){a.successMessage="3DS CRes Browser test case '"+c.testCaseName+"' updated";c.previousTestCase=c.selectedTestCase}else{if(g=="delete"){a.successMessage="3DS CRes Browser test case '"+c.testCaseName+"' deleted"}}}d.scrollTo(0,0)},function f(j){c.loading=false;a.showSuccessAlert=false;a.showErrorAlert=true;if(j.data.errorMessage!=null){a.errorMessage=j.data.errorMessage}else{a.errorMessage="Transaction Failed"}d.scrollTo(0,0)})};c.deleteConfirm=function(){if(d.confirm("Are you sure you want to delete '"+c.testCaseName+"' test case")){c.mpiCResSubmit("delete")}}}]);