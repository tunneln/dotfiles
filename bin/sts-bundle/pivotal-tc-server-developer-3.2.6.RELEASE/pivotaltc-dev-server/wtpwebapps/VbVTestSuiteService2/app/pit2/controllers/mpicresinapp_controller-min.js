"use strict";var mpiCResInAppMod=angular.module("MPICResInAppModule",[]);mpiCResMod.controller("MPICResInAppCtrl",["$scope","AdministerTestsServiceInappPIT2","$rootScope","$window",function(b,d,a,c){b.loading=false;b.pageloaded=true;b.componentType="MPI";b.applnId="PIT2";b.msgType="CRes";b.selectedTestCase;b.testCaseType="01";b.testCaseName;b.requiredByRegion;b.pan;b.pitAction;b.cResTemplate;b.compliance;b.previousTestCase;b.actionTemplates=[];b.pitActions=["None","Generate Invalid ACS Signature","Use Expired ACS Signing Certificate","Include newlines in BASE64","Use ECommerce Signing Certificate"];b.selectedTestCaseObj={};b.isExistingTC=false;b.cResTemplate={};b.cReqMandFields;b.getTestCases=function(f,e){b.testCases=[];b.tcResData=[];b.actionTemplates=[];d.getTestCases(f,e).then(function(g){b.tcResData=g.data;if(b.tcResData.length>0){b.isExistingTC=true;angular.forEach(b.tcResData,function(i){b.testCases.push({tcId:i.testCaseId,tcDesc:i.tc_desc})});if(b.previousTestCase>0||b.previousTestCase!=null){var h=b.tcResData.map(function(i){return i.testCaseId}).indexOf(b.previousTestCase);b.selectedTestCaseObj=b.tcResData[h];b.setData(b.selectedTestCaseObj);b.previousTestCase=null}else{b.selectedTestCaseObj=b.tcResData[0];b.setData(b.selectedTestCaseObj)}}else{if(b.tcResData.length==0){b.isExistingTC=false;b.pageloaded=false;b.pitAction="None";b.cResTemplate="";b.cReqMandFields=""}else{b.isExistingTC=false}}})};b.getTestCases(b.msgType,b.testCaseType);b.setData=function(e){b.selectedTestCase=e.testCaseId;b.testCaseName=e.tcName;b.compliance=e.compliance;b.cReqMandFields=e.expctdMpiReqFields;b.pan=e.pan;if(e.tcActionTmpl.length>0){b.pitAction=e.tcActionTmpl[0].actnTemplName}b.cResTemplate=e.templeteMsg;b.pageloaded=false};b.jsonFormat=function(f){if(f=="CRes"){var g=b.cResTemplate;b.cResTemplate=vkbeautify.json(g,1)}if(f=="expCResResp"){var e=b.expectedResMsg;b.expectedResMsg=vkbeautify.json(e,1)}};b.jsonUnformat=function(f){if(f=="CRes"){var g=b.cResTemplate;b.cResTemplate=vkbeautify.jsonmin(g)}if(f=="expCResResp"){var e=b.expectedResMsg;b.expectedResMsg=vkbeautify.jsonmin(e)}};b.changeTCReqData=function(f){var e=b.tcResData.map(function(g){return g.testCaseId}).indexOf(f);if(e!=-1){b.isExistingTC=true;b.selectedTestCaseObj=b.tcResData[e];b.setData(b.selectedTestCaseObj)}else{b.isExistingTC=false;b.selectedTestCase="";b.testCaseName="";b.pan="";b.pitAction="None";b.cResTemplate="";b.actionTemplates=[];b.cReqMandFields=""}};b.mpiCResSubmit=function(g,h){b.actionTemplates=[];b.actionTemplates.push(b.pitAction);var i={operationType:g,testCaseId:b.selectedTestCase,tcName:b.testCaseName,pan:b.pan,templeteMsg:b.cResTemplate,actnTemplName:b.actionTemplates,componentType:b.componentType,applnId:b.applnId,msgType:b.msgType,deviceChannel:b.testCaseType,compliance:b.compliance,expctdMpiReqFields:b.cReqMandFields};b.loading=true;d.createNewTestCase(i).then(function e(j){b.loading=false;b.getTestCases(b.msgType,b.testCaseType);a.showErrorAlert=false;a.showSuccessAlert=true;if(g=="create"){a.successMessage="3DS CRes InApp test case '"+b.testCaseName+"' created"}else{if(g=="update"){a.successMessage="3DS CRes InApp test case '"+b.testCaseName+"' updated";b.previousTestCase=b.selectedTestCase}else{if(g=="delete"){a.successMessage="3DS CRes InApp test case '"+b.testCaseName+"' deleted"}}}c.scrollTo(0,0)},function f(j){b.loading=false;a.showSuccessAlert=false;a.showErrorAlert=true;if(j.data.errorMessage!=null){a.errorMessage=j.data.errorMessage}else{a.errorMessage="Transaction Failed"}c.scrollTo(0,0)})};b.deleteConfirm=function(){if(c.confirm("Are you sure you want to delete '"+b.testCaseName+"' test case")){b.mpiCResSubmit("delete")}}}]);