"use strict";var reviewTestActModpit2=angular.module("PIT2ReviewTestMod",[]);reviewTestActModpit2.controller("PIT2ReviewTestController",["PIT2ReviewService","$rootScope","$scope","$http","$state","$timeout","$location","$interval",function(e,k,l,j,b,d,f,i){$(function(){setTimeout(function(){var m=$("#datepicker").val();$("#datepicker")[o(m)]("x");$("#datepicker").datepicker({dateFormat:"yy-mm-dd",changeMonth:true,changeYear:true});$("#datepicker").change(function(){var p=$("#datepicker").val();console.log("in change :: "+p);$("#datepicker")[o(p)]("x")});function o(p){return p?"addClass":"removeClass"}$(document).on("input",".clearable",function(){$(this)[o(this.value)]("x")}).on("mousemove",".x",function(p){$(this)[o(this.offsetWidth-18<p.clientX-this.getBoundingClientRect().left)]("onX")}).on("touchstart click",".onX",function(p){p.preventDefault();$(this).removeClass("x onX").val("").change()});$("#datepicker").keydown(function(){var q=window.event;var p=q.keyCode||q.which;if(p===9||p===16){return}else{return false}});var n=$("#datepickerEnd").val();$("#datepickerEnd")[o(n)]("x");$("#datepickerEnd").datepicker({dateFormat:"yy-mm-dd",changeMonth:true,changeYear:true});$("#datepickerEnd").change(function(){var p=$("#datepickerEnd").val();$(this)[o(p)]("x")});function o(p){return p?"addClass":"removeClass"}$(document).on("input",".clearable",function(){$(this)[o(this.value)]("x")}).on("mousemove",".x",function(p){$(this)[o(this.offsetWidth-18<p.clientX-this.getBoundingClientRect().left)]("onX")}).on("touchstart click",".onX",function(p){p.preventDefault();$(this).removeClass("x onX").val("").change()});$("#datepickerEnd").keydown(function(){var q=window.event;var p=q.keyCode||q.which;if(p===9||p===16){return}else{return false}})})},5000);l.curPage=0;l.pageSize=10;l.service=e;l.testerId=k.loggedInUser;l.userType=k.userType;l.isAdmin=k.isAdmin;l.isRegnAdmin=k.isRegnAdmin;l.dropdownShow=false;l.comptype="";l.comlen="";l.threeDSServer="3DS Server";l.testType="All";if(k.userAccess.length>0){if(k.userPit2ComponentType.length>1){l.dropdownShow=true;l.comlen=k.userPit2ComponentType.length}else{if(k.userPit2ComponentType=="ACS"){l.dropdownShow=false;l.component="ACS";l.comlen=k.userPit2ComponentType.length}else{l.dropdownShow=false;l.component="MPI";l.comlen=k.userPit2ComponentType.length}}}var a;var c={"Content-Type":" application/json"};var h=0;var g=0;l.resLen;l.numberOfPages=function(){l.noOfPages=Math.ceil(h/l.pageSize)};l.stopTimeout=function(){d.cancel(a)};l.startTimeout=function(){var m=angular.element(document.querySelector("#ssb"));g++;m.val("Stop Auto Reload");a=d(function(){l.getUserTestCases();l.startTimeout();if(g==10){m.val("Start Auto Reload");l.stopTimeout();g=0}},30000)};l.stopTimeout();l.auto_reload=function(){var m=angular.element(document.querySelector("#ssb"));if(m.val()=="Start Auto Reload"){m.val("Stop Auto Reload");l.startTimeout()}else{m.val("Start Auto Reload");l.stopTimeout();g=0}};l.getUserTestCases=function(){l.curPage=0;k.showErrorAlert=false;k.errorMessage="";if(l.testerId==""){k.showErrorAlert=true;k.errorMessage="Please Enter the Valid Tester ID";return}if((l.minTestId!=undefined&&l.maxTestId!=undefined)&&(parseInt(l.minTestId)>parseInt(l.maxTestId))){k.showErrorAlert=true;k.errorMessage="Invalid Max Test ID";return}if((l.startDate!=undefined&&l.endDate!=undefined)&&((l.startDate)>(l.endDate))&&l.startDate!=""&&l.endDate!=""){k.showErrorAlert=true;k.errorMessage="Invalid End Date";return}var o={Email:angular.lowercase(l.testerId),MinTransactionID:l.minTestId,StartDate:l.startDate,StartTime:l.startTime,Status:l.status,ComponentType:l.component,MaxTransactionID:l.maxTestId,EndDate:l.endDate,EndTime:l.endTime,TestCaseType:l.testType};l.pageLoading=true;e.reviewLoad(o).then(function m(q,p,r){l.resData=q.data.revDispList;l.pageLoading=false;if(l.resData!=undefined){l.resLen=l.resData.length;h=l.resLen;l.numberOfPages()}else{l.resLen=0;h=l.resLen}},function n(p){l.pageLoading=false;k.showSuccessAlert=false;k.showErrorAlert=true;if(p.data.errorMessage!=undefined&&p.data.errorMessage!=null){k.errorMessage=p.data.errorMessage}l.resLen=0;h=l.resLen})};if(e.isReturn){e.isReturn=false;l.testerId=e.email;l.component=e.componentType;l.startDate=e.startDate;l.endDate=e.endDate;l.status=e.status;l.testType=e.testType;l.startTime=e.startTime;l.endTime=e.endTime;l.resData=e.previousSearchResults;l.resLen=l.resData.length;h=l.resLen;l.numberOfPages();l.curPage=e.currentPage;if(l.selectedComponent=="ACS"){l.title="Review ACS Required Test Results"}else{if(l.selectedComponent=="MPI"){l.title="Review 3DS Server Required Test Results"}}}else{l.getUserTestCases()}l.testId=function(n,m){e.reviewTestCase(n,m).success(function(p,o,q){l.service.data=p;if(m=="ACS"||m=="ACS_REQUIRED"){b.go("PIT2.reviewACS")}else{if(m=="MPI"||m=="MPI_REQUIRED"){b.go("PIT2.reviewMPI")}else{b.go("PIT2.reviewPARESBATCH")}}e.backActionState="PIT2.PIT2reviewTestActivity";e.email=l.testerId;e.componentType=l.component;e.startDate=l.startDate;e.endDate=l.endDate;e.status=l.status;e.testType=l.testType;e.startTime=l.startTime;e.endTime=l.endTime;e.previousSearchResults=l.resData;e.currentPage=l.curPage;e.backBtn=false;e.cthBckBtn=false;e.noTestCases=false}).error(function(p,o){b.go("PIT2.PIT2reviewTestActivity")})}}]);angular.module("PIT2ReviewTestMod").filter("pagination",function(){return function(a,b){if(!a||!a.length){return}b=+b;return a.slice(b)}});reviewTestActModpit2.filter("htmlvw",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]);reviewTestActModpit2.filter("beautify",function(){return function(a){return vkbeautify.json(a,2)}});