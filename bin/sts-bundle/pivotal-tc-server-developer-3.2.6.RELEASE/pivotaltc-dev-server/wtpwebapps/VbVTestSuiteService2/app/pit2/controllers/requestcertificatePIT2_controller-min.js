"use strict";var requestCertificateModPIT2=angular.module("RequestCertificateModPIT2",[]);requestCertificateModPIT2.controller("RequestCertificateControllerPIT2",["$scope","$rootScope","$state","RequestCertificateServicePIT2","$window","RequestCertificateServiceHomePIT2",function(c,b,e,a,f,d){c.service=a;c.loading=false;c.email=b.loggedInUser;c.showTitle=d.isAcsSign;if(d.isAcsSign){c.certificate="ECSigning"}else{c.certificate="RSACertificate"}c.certificates=[{name:"RSA Certificate",value:"RSACertificate"}];c.signCertificates=[{name:"EC Signing",value:"ECSigning"}];c.save=function(){console.log("$scope.certificate"+c.certificate);b.errorMessage="";var j=true;var i={certType:c.certificate,email:c.email,requestCertFile:c.fileData,csr:c.certRequest};if(c.email==undefined||c.certificate==undefined||c.fileData==undefined&&(c.certRequest==undefined||c.certRequest=="")){j=false;b.showSuccessAlert=false;b.showErrorAlert=true;b.errorMessage="Please fill the mandatory fields properly";f.scrollTo(0,0)}else{if(c.fileData!=undefined&&(c.certRequest!=undefined)&&c.certRequest!=""){j=false;b.showSuccessAlert=false;b.showErrorAlert=true;b.errorMessage="Please choose a file or paste certificate request in text area box";f.scrollTo(0,0)}}if(j){c.loading=true;a.save(i).then(function g(k){c.service.data=k.data;if(k.data.EmailSent==true){b.success="Your certificate successfully sent to your registered email.For more details please contact the V3DSTS administrator. "}else{b.failure="An error occurred attempting to send your certificate to email.Please contact the V3DSTS administrator. "}e.go("PIT2.requestCertificateRes")},function h(l,k){c.loading=false;e.go("PIT2.requestCertificate");b.showSuccessAlert=false;b.showErrorAlert=true;f.scrollTo(0,0)})}};c.resetForm=function(g){b.showSuccessAlert=false;b.showErrorAlert=false;if(g){c.certificate="ECSigning"}else{c.certificate="RSACertificate"}c.email=b.loggedInUser;c.fileData=undefined;angular.element("input[type='file']").val(null);c.certRequest=undefined};c.back=function(){d.isAcsSign=false;e.go("PIT2.requestCertificateHome")}}]);