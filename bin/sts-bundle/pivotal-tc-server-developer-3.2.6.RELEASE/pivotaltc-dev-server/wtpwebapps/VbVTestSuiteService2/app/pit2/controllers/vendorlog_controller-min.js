var vendorLogMod=angular.module("VendorLogMod",[]);vendorLogMod.controller("vendorLogCtrl",["$scope","$rootScope","$state","$localStorage","VendorLogService","$window","ManageProfileService","UserEnrollmentService","DTOptionsBuilder",function(h,f,b,g,d,e,a,c,i){h.complianceDetails=[];h.isPageLoading=false;h.dtOptions=i.newOptions().withDisplayLength(10).withOption("bLengthChange",false);h.getAllVendorDetails=function(){h.isPageLoading=true;d.getVendorLogDetails().then(function j(l){console.log("Get vendor log details success "+l.data.length);h.complianceDetails=l.data;h.isPageLoading=false},function k(l){console.log("Failed to get the vendor log details.");h.isPageLoading=false})};h.getAllVendorDetails();h.approveVendorCompliance=function(j){d.vendorData=j;b.go("PIT2.approveDenyCompliance")};h.pit2components=[{id:"ACS",value:"ACS",selected:false},{id:"3DS Server",value:"MRCH",selected:false}];h.vendorDataLoading=false;h.isPIT2ACS=false;h.isMerchant=false;h.getCountries=function(){c.getCountries().then(function j(l){h.countries=l.data},function k(l){console.log("Failed to get the countries list")})};h.getVendorData=function(j){h.vendorDataLoading=true;h.getCountries();h.pit1SelectedComponents=[];h.pit2SelectedComponents=[];h.selectedTLSVersions=[];h.selectedTestsDescs=[];h.selectedVersions=[];console.log("userEmail "+j);a.getUserData(j).then(function(k){console.log("user data response ;: "+k.data.emailAddr);var l=k.data;h.email=l.emailAddr;h.password=l.password;h.confirmPassword=l.confirmPassword;h.name=l.usrNm;h.company=l.coNm;h.streetAddress=l.str1Addr;h.city=l.cityNm;h.country=l.ctryCd;h.phone=l.phnNum;h.bin=l.bin;h.acsVerificationEnrollUrl=l.acsUrl;h.merchantId=l.mrchId;h.merchantPwd=l.merchPassword;h.merchantConfirmPwd=l.mrchConfirmPassword;h.batchSubmission=l.allowPAResBatchSbum;h.allowVIP=l.allowSubmVIP;h.allowVCMS=l.allowSubmVCMS;h.merchantRefNum=l.mrchRefNum;h.pit2ACSUrl=l.pit2Url;h.mrchPswdEncrptdVal=l.mrchPswdEncrptdVal;h.firstName=l.firstName;h.lastName=l.lastName;h.stateOrTerritory=l.stateORTerritory,h.postalCode=l.postalCode;h.acquirerBin=l.acquirerBin;h.acsReference=l.acsReference;angular.forEach(l.userRoles,function(n){if(n!="ADMIN"){var m=n.split("_");if(h.selectedVersions!=null&&h.selectedVersions.length>0){if(h.selectedVersions.indexOf(m[0])==-1){h.selectedVersions.push(m[0])}}else{h.selectedVersions.push(m[0])}if(m[0]=="PIT1"){h.pit1SelectedComponents.push(m[1])}else{if(m[0]=="PIT2"){h.pit2SelectedComponents.push(m[1])}}}else{h.admin=true}});angular.forEach(h.versions,function(m){if(h.selectedVersions.indexOf(m.id)!=-1){if(m.id=="PIT1"){h.isPIT1=true;m.selected=true}else{if(m.id=="PIT2"){h.PIT2Selected=true;m.selected=true}else{m.selected=false}}}});angular.forEach(h.pit2components,function(m){if(h.pit2SelectedComponents.indexOf(m.value)!=-1){if(m.value==COMPONENTS.ACS){h.isPIT2ACS=true;m.selected=true}else{if(m.value==COMPONENTS.MRCH){h.isMerchant=true;m.selected=true}else{m.selected=false}}}});angular.forEach(h.tlsVersions,function(m){if(l.tlsVersions.indexOf(m.id)!=-1){m.selected=true}});h.selectedTLSVersions=l.tlsVersions;h.pit2Url=l.pit2Url;h.visaComplLetterId=l.visaComplLetterId;h.businessId=l.businessId;h.vendorDataLoading=false})};h.approveVendorReg=function(j){console.log("vendorData.enrollmentUUIDToken :: "+j.enrollmentUUIDToken);if(j.enrollmentUUIDToken!=null&&j.enrollmentUUIDToken!=undefined){f.token=j.enrollmentUUIDToken}else{f.token=""}f.redirectFromVendorLog=true;b.go("approveEnrolledUser")}}]);